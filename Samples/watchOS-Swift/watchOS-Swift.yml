# yaml-language-server: $schema=../../schema/xcodegen.schema.json

name: watchOS-Swift
include:
  - ../Shared/feature-flags.yml
createIntermediateGroups: true
generateEmptyDirectories: true
configs:
  Debug: debug
  Test: debug
  TestCI: debug
  Release: release
projectReferences:
  Sentry:
    path: ../../Sentry.xcodeproj
  SentrySampleShared:
    path: ../SentrySampleShared/SentrySampleShared.xcodeproj
fileGroups:
  - ../Shared/Config
  - WatchApp/Configuration
  - Extension/Configuration
  - watchOS-Swift.yml
options:
  bundleIdPrefix: io.sentry
  defaultSourceDirectoryType: syncedFolder
targets:
  App:
    type: "application.watchapp2"
    platform: auto
    sources:
      - WatchApp/Resources
      - ../Shared/SampleAssets.xcassets
    dependencies:
      - target: Extension
      - target: SentrySampleShared/SentrySampleShared
    configFiles:
      Debug: WatchApp/Configuration/watchOS-Swift-App.xcconfig
      Release: WatchApp/Configuration/watchOS-Swift-App.xcconfig
      Test: WatchApp/Configuration/watchOS-Swift-App.xcconfig
      TestCI: WatchApp/Configuration/watchOS-Swift-App.xcconfig
  Extension:
    type: "watchkit2-extension"
    platform: auto
    sources:
      - Extension/Sources
      - Extension/Resources
      - ../Shared/SampleAssets.xcassets
    dependencies:
      - target: Sentry/Sentry
      - target: SentrySampleShared/SentrySampleShared
    configFiles:
      Debug: Extension/Configuration/watchOS-Swift-Extension.xcconfig
      Release: Extension/Configuration/watchOS-Swift-Extension.xcconfig
      Test: Extension/Configuration/watchOS-Swift-Extension.xcconfig
      TestCI: Extension/Configuration/watchOS-Swift-Extension.xcconfig
    postCompileScripts:
      - script: ../Shared/inject-git-info.sh
        name: Inject Git Information into Info.plist
        basedOnDependencyAnalysis: false
    postBuildScripts:
      - script: ../Shared/reset-git-info.sh
        name: Reset Git Fields in Info.plist
        basedOnDependencyAnalysis: false
schemes:
  "watchOS-Swift WatchKit App":
    templates:
      - SampleAppScheme
    build:
      targets:
        App: all
